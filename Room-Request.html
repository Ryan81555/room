<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê°ì‹¤ ìš”ì²­/ë¬¸ì˜</title>
  <link rel="stylesheet" href="assets/css/main.css">
  <style>
    *,
    *::before,
    *::after {
    box-sizing: border-box;
    }
    body { background: linear-gradient(135deg, #e0e7ff 0%, #f0fdfa 100%); margin: 0; padding: 0; }
    .request-container { max-width: 420px; margin: 32px auto; background: rgba(255,255,255,0.95); border-radius: 18px; box-shadow: 0 8px 32px rgba(52,152,219,0.13); padding: 24px 16px; }
    .request-title { text-align:center; color:#2563eb; margin-bottom:18px; font-size:1.4em; font-weight:700; }
    .input-group { margin-bottom: 18px; }
    .input-label { font-weight:600; margin-bottom:6px; display:block; color:#2563eb; }
    .input-field, textarea { width:100%; padding:12px; border-radius:8px; border:1px solid #bcd; font-size:1.1em; }
    .quick-btns { display:flex; flex-wrap:wrap; gap:8px; margin-bottom:14px; }
    .quick-btn { flex:1 1 45%; background:#f0fdfa; color:#2563eb; border:1px solid #60a5fa; border-radius:8px; padding:12px 0; font-weight:600; cursor:pointer; transition:background 0.2s; font-size:1.05em; }
    .quick-btn.selected, .quick-btn:hover { background:#60a5fa; color:#fff; }
    .submit-btn { width:100%; background:#2563eb; color:#fff; border:none; border-radius:8px; padding:15px 0; font-size:1.15em; font-weight:700; cursor:pointer; margin-top:10px; }
    #adminLoginBox { max-width:340px;margin:40px auto 0 auto;background:#fff;border-radius:12px;box-shadow:0 4px 16px #0001;padding:32px 18px; }
    @media (max-width: 700px) {
      .request-container { max-width:100vw; padding: 0 0 24px 0; border-radius:0; box-shadow:none; margin:0; }
      .request-title { font-size:1.1em; padding:10px 0; }
      .input-field, textarea { font-size:1.05em; padding:14px 8px; }
      .quick-btns { flex-direction:column; gap:7px; }
      .quick-btn { width:100%; min-width:0; font-size:1.07em; padding:15px 0; }
      .submit-btn { font-size:1.13em; padding:16px 0; }
      #adminLoginBox { max-width:99vw; border-radius:0; box-shadow:none; margin:0; }
    }
    .notice-msg {
      background: #f0fdfa;
      color: #2563eb;
      border: 1px solid #60a5fa;
      border-radius: 8px;
      padding: 12px 10px;
      margin-bottom: 18px;
      font-size: 1.05em;
      text-align: center;
    }
    .notice-guide
    {
      background: #f0fdfa;
      color: #2563eb;
      border: 1px solid #60a5fa;
      border-radius: 8px;
      padding: 12px 10px;
      margin-bottom: 18px;
      font-size: 1.05em;
      text-align: center;
    }
    @media (max-width: 700px) {
      .request-container {
        max-width: 99vw;
        padding: 8vw 2vw;
        border-radius: 0;
        box-shadow: none;
        margin: 0;
      }
      .request-title {
        font-size: 1.1em;
        padding: 10px 0;
      }
      .input-field, textarea {
        font-size: 1.05em;
        padding: 14px 8px;
      }
      .quick-btns {
        flex-direction: column;
        gap: 7px;
      }
      .quick-btn {
        width: 100%;
        min-width: 0;
        font-size: 1.07em;
        padding: 15px 0;
      }
      .submit-btn {
        font-size: 1.13em;
        padding: 16px 0;
      }
      #adminLoginBox {
        max-width: 99vw;
        border-radius: 0;
        box-shadow: none;
        margin: 0;
      }
      .cafe-promo {
        padding: 6vw 2vw !important;
        font-size: 1em !important;
      }
      .cafe-promo img {
        width: 98% !important;
        max-width: 99vw !important;
        height: auto !important;
      }
      .cafe-gallery {
        flex-wrap: wrap;
        gap: 6px !important;
      }
      .cafe-gallery img {
        width: 44vw !important;
        max-width: 140px !important;
        min-width: 90px !important;
        margin-bottom: 4px;
      }
    }
  </style>
</head>
<body>
  <audio id="notifySound" src="sound/mlg-airhorn.mp3" preload="auto"></audio>
  <div class="request-container">
    <div class="request-title">ê°€í‰ ì›”ë“œë¹Œë¦¬ì§€<br>ê°ì‹¤ ìš”ì²­/ë¬¸ì˜</div>
    <div class="notice-msg">
      ì›í™œí•œ ì„œë¹„ìŠ¤ ì œê³µê³¼ ì‹œìŠ¤í…œ ì•ˆì •í™”ë¥¼ ìœ„í•´ <br>ë¬¸ì˜ ë° ìš”ì²­ì‚¬í•­ ì ‘ìˆ˜ëŠ” <br><b>3ë¶„ì— í•œ ë²ˆ</b>ìœ¼ë¡œ ì œí•œë©ë‹ˆë‹¤.<br>
      ì§§ì€ ì‹œê°„ì— ì¤‘ë³µ ìš”ì²­ ì‹œ ì‹œìŠ¤í…œì—<br> ê³¼ë¶€í•˜ê°€ ë°œìƒí•˜ê±°ë‚˜ ìš”ì²­ì´ ëˆ„ë½ë  ìˆ˜ ìˆìœ¼ë‹ˆ, <br>ì´ìš©ì ì—¬ëŸ¬ë¶„ì˜ ë„ˆê·¸ëŸ¬ìš´ ì–‘í•´ ë¶€íƒë“œë¦½ë‹ˆë‹¤.<br>
      <span style="color:#e11d48;">ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤.</span>
    </div>
    <div class="request-container">
      <!-- ì—¬ê¸°! -->
      <div class="notice-guide"> <h3>ì´ˆê°„ë‹¨ ìš”ì²­ì‚¬í•­ ë° ë¬¸ì˜ì‚¬í•­ ë°©ë²•</h3>

        <p>
            <strong>1. ë‚´ ì •ë³´ ì…ë ¥</strong><br>
            ë™/í˜¸ìˆ˜ì™€ ì „í™”ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì ì–´ì£¼ì„¸ìš”.
        </p>
        
        <p>
            <strong>2. ìš”ì²­ì‚¬í•­ ì„ íƒ</strong><br>
            ìì£¼ ìˆëŠ” ìš”ì²­ ë²„íŠ¼ì„ ëˆ„ë¥´ê±°ë‚˜, <br>ì•„ë˜ ê¸°íƒ€ ìš”ì²­ì‚¬í•­ì— ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.
        </p>
        
        <p>
            <strong>3. ì „ì†¡í•˜ë©´ ë!</strong><br>
            íŒŒë€ìƒ‰ ìš”ì²­í•˜ê¸° ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ <br>ë°”ë¡œ ì ‘ìˆ˜ë©ë‹ˆë‹¤.
        </p>
        
        <hr>
        
        <p>
            <strong>â˜… ì¤‘ìš”:</strong> ì›í™œí•œ ì²˜ë¦¬ë¥¼ ìœ„í•´<br> ìš”ì²­ì€ 3ë¶„ì— í•œ ë²ˆì”©ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤!
        </p> </div>
      <div class="request-title">ê°ì‹¤ ìš”ì²­/ë¬¸ì˜</div>
      <!-- ì´í•˜ ìƒëµ -->
    </div>
    <form id="requestForm">
      <div class="input-group">
        <label class="input-label" for="room">ë™/í˜¸ìˆ˜</label>
        <input class="input-field" type="text" id="room" name="room" placeholder="ì˜ˆ:Cë™ 101" required>
      </div>
      <div class="input-group">
        <label class="input-label" for="phone">ì „í™”ë²ˆí˜¸</label>
        <input class="input-field" type="tel" id="phone" name="phone" placeholder="ì˜ˆ: 010-1234-5678" required>
      </div>
      <div class="input-group">
        <span class="input-label">ìì£¼ ìˆëŠ” ìš”ì²­</span>
        <div class="quick-btns">
          <button type="button" class="quick-btn" data-type="ì˜ˆì•½ìƒë‹´">ì˜ˆì•½ìƒë‹´</button>
          <button type="button" class="quick-btn" data-type="íœ´ì§€ê°€ ì—†ì–´ìš”">íœ´ì§€ê°€ ì—†ì–´ìš”</button>
          <button type="button" class="quick-btn" data-type="TVê°€ ì•ˆ ë‚˜ì™€ìš”">TVê°€ ì•ˆ ë‚˜ì™€ìš”</button>
          <button type="button" class="quick-btn" data-type="ë³€ê¸°ê°€ ë§‰í˜”ì–´ìš”">ë³€ê¸°ê°€ ë§‰í˜”ì–´ìš”</button>
          <button type="button" class="quick-btn" data-type="í™”ì¥ì‹¤ ë¬¸ì´ ì ê²¼ì–´ìš”">í™”ì¥ì‹¤ ë¬¸ì´ ì ê²¼ì–´ìš”</button>
          <button type="button" class="quick-btn" data-type="ì¹¨êµ¬ë¥˜ë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ì–´ìš”.">ì¹¨êµ¬ë¥˜ë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ì–´ìš”.</button>
          <button type="button" class="quick-btn" data-type="ì—ì–´ì»¨/ë‚œë°©ì´ ì˜ ì•ˆ ë¼ìš”.">ì—ì–´ì»¨/ë‚œë°©ì´ ì˜ ì•ˆ ë¼ìš”.</button>
          <button type="button" class="quick-btn" data-type="ì™€ì´íŒŒì´ê°€ ì—°ê²°ë˜ì§€ ì•Šì•„ìš”.">ì™€ì´íŒŒì´ê°€ ì—°ê²°ë˜ì§€ ì•Šì•„ìš”.</button>
          <button type="button" class="quick-btn" data-type="ì¸ë•ì…˜ ì‘ë™í•˜ì§€ ì•Šì•„ìš”.">ì¸ë•ì…˜ ì‘ë™í•˜ì§€ ì•Šì•„ìš”.</button>
          <button type="button" class="quick-btn" data-type="ë‹¤ë¥¸ ê°ì‹¤ì´ ë„ˆë¬´ ì‹œë„ëŸ¬ì›Œìš”.">ë‹¤ë¥¸ ê°ì‹¤ì´ ë„ˆë¬´ ì‹œë„ëŸ¬ì›Œìš”.</button>
          <button type="button" class="quick-btn" data-type="ì˜¨ìˆ˜ê°€ ì•ˆë‚˜ì™€ìš”">ì˜¨ìˆ˜ê°€ ì•ˆë‚˜ì™€ìš”</button>
        </div>
      </div>
      <div class="input-group">
        <label class="input-label" for="detail">ê¸°íƒ€ ìš”ì²­ì‚¬í•­</label>
        <textarea id="detail" name="detail" rows="3" placeholder="ê¸°íƒ€ ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”."></textarea>
      </div>
      <button type="submit" class="submit-btn">ìš”ì²­í•˜ê¸°</button>
    </form>
    <div id="resultMsg" style="display:none;"></div>
  </div>
  <!-- ìš”ì²­ ì™„ë£Œ ëª¨ë‹¬ -->
  <div id="successModal" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.35);align-items:center;justify-content:center;">
    <div style="background:#fff;border-radius:18px;box-shadow:0 8px 32px rgba(52,152,219,0.18);padding:38px 24px;max-width:90vw;text-align:center;">
      <div style="font-size:1.35em;font-weight:700;color:#22c55e;margin-bottom:12px;">ì •ìƒì ìœ¼ë¡œ ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!<br>ì›í™œí•œ ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•´ ìš”ì²­ì€ 3ë¶„ì— í•œ ë²ˆì”©ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
      <button id="closeModalBtn" style="margin-top:10px;padding:10px 28px;background:#2563eb;color:#fff;border:none;border-radius:8px;font-size:1em;font-weight:600;cursor:pointer;">í™•ì¸</button>
    </div>
  </div>
  <div class="cafe-promo" style="
  background: #fff7ed;
  border: 1.5px solid #fdba74;
  border-radius: 14px;
  padding: 22px 14px;
  margin: 32px 0 18px 0;
  color: #b45309;
  font-size: 1.08em;
  box-shadow: 0 4px 16px #fdba741a;
  text-align: center; /* ê°€ìš´ë° ì •ë ¬ ì¶”ê°€ */
">
  <div style="font-size:1.25em; font-weight:700; color:#ea580c; margin-bottom:10px;">
    ğŸ‰ ì›”ë“œë¹Œë¦¬ì§€ ê³ ê° ì „ìš© ê°€í‰ ì¹´í˜ íŠ¹ë³„ í• ì¸!
  </div>
  <div style="margin-bottom:10px;">
    ì €í¬ ì›”ë“œë¹Œë¦¬ì§€ì— ì˜¤ì‹  ë¶„ë“¤ê»˜ë§Œ ë“œë¦¬ëŠ” í˜œíƒ!<br>
    <b>ê°€í‰ "ì¹´í˜ ë ˆì´í¬ì• ë¹„ë‰´"</b>ì—ì„œ <span style="color:#ea580c;font-weight:600;">ìŒë£Œ ì „í’ˆëª© 10% í• ì¸</span>ì„ ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
    <span style="color:#b91c1c;">(â€» ë² ì´ì»¤ë¦¬ë¥˜ëŠ” í• ì¸ ì œì™¸)</span>
  </div>
  <div style="margin-bottom:10px;">
    <b>í• ì¸ ë°©ë²•:</b> ì²´í¬ì¸ ì‹œ ë°›ìœ¼ì‹  ì•ˆë‚´ ë¬¸ì ë‚´ì—­ì„ ì¹´í˜ ì§ì›ì—ê²Œ ë³´ì—¬ì£¼ì„¸ìš”!
  </div>
  <div style="margin-bottom:10px;">
    <b>ì¹´í˜ ìœ„ì¹˜:</b> ê°€í‰êµ° í˜¸ë°˜ë¡œ 1526 (ì›”ë“œë¹Œë¦¬ì§€ì—ì„œ ì°¨ëŸ‰ 10ë¶„) ì„¤ì•… IC ë°©í–¥
  </div>
<!-- ê°¤ëŸ¬ë¦¬ ì „ì²´ë¥¼ ê°ì‹¸ëŠ” div -->
<div class="cafe-gallery" style="display: flex; flex-direction: column; gap: 8px; align-items: center; margin-top: 10px;">
  <!-- 1ì¸µ (ìœ—ì¤„) -->
  <div style="display: flex; gap: 10px;">
    <img src="images/101.jpg" alt="ì¹´í˜ ì „ê²½1" style="width: 300px; height: 200px; border-radius: 8px; border: 1px solid #fdba74; cursor: pointer;" onclick="openImageModal(this.src)">
    <img src="images/102.jpg" alt="ì¹´í˜ ì „ê²½2" style="width: 300px; height: 200px; border-radius: 8px; border: 1px solid #fdba74; cursor: pointer;" onclick="openImageModal(this.src)">
  </div>
  <!-- 2ì¸µ (ì•„ë«ì¤„) -->
  <div style="display: flex; gap: 10px;">
    <img src="images/104.jpg" alt="ì¹´í˜ ì „ê²½3" style="width: 300px; height: 200px; border-radius: 8px; border: 1px solid #fdba74; cursor: pointer;" onclick="openImageModal(this.src)">
    <img src="images/105.jpg" alt="ì¹´í˜ ì „ê²½4" style="width: 300px; height: 200px; border-radius: 8px; border: 1px solid #fdba74; cursor: pointer;" onclick="openImageModal(this.src)">
  </div>
</div>
</div>
  <script>
    let selectedType = '';
    document.querySelectorAll('.quick-btn').forEach(btn => {
      btn.onclick = function() {
        document.querySelectorAll('.quick-btn').forEach(b => b.classList.remove('selected'));
        this.classList.add('selected');
        selectedType = this.getAttribute('data-type');
      };
    });
    document.getElementById('requestForm').onsubmit = async function(e) {
      e.preventDefault();
      const room = document.getElementById('room').value.trim();
      const phone = document.getElementById('phone').value.trim(); // ì¶”ê°€
      const detail = document.getElementById('detail').value.trim();
      if (!room) { alert('ê°ì‹¤ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.'); return; }
      if (!phone) { alert('ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.'); return; } // ì¶”ê°€
      if (!selectedType && !detail) { alert('ìš”ì²­ì‚¬í•­ì„ ì„ íƒí•˜ê±°ë‚˜ ì…ë ¥í•´ ì£¼ì„¸ìš”.'); return; }
      const res = await fetch('/api/requests', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ room, phone, type: selectedType || 'ê¸°íƒ€', detail }) // phone í¬í•¨!
      });
      if (res.ok) {
        document.getElementById('requestForm').reset();
        document.querySelectorAll('.quick-btn').forEach(b => b.classList.remove('selected'));
        selectedType = '';
        // ëª¨ë‹¬ í‘œì‹œ
        document.getElementById('successModal').style.display = 'flex';
      } else {
        alert('ìš”ì²­ ì ‘ìˆ˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
      }
    };
    // ëª¨ë‹¬ ë‹«ê¸°
    document.getElementById('closeModalBtn').onclick = function() {
      document.getElementById('successModal').style.display = 'none';
    };

    // ë¸Œë¼ìš°ì € í‘¸ì‰¬ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
    if (window.Notification && Notification.permission !== "granted") {
      Notification.requestPermission();
    }

    async function fetchRequests() {
      const res = await fetch('/api/requests');
      if (res.ok) {
        const data = await res.json();
        // ìƒˆ ìš”ì²­ì´ ë“¤ì–´ì™”ëŠ”ì§€ ì²´í¬
        const newCount = data.filter(r => r.status === 'ëŒ€ê¸°').length;
        if (newCount > lastRequestCount) {
          // ì‚¬ìš´ë“œ ì•Œë¦¼
          document.getElementById('notifySound').play();
          // í‘¸ì‰¬ì•Œë¦¼
          if (window.Notification && Notification.permission === "granted") {
            new Notification("ìƒˆë¡œìš´ ìš”ì²­ì´ ë„ì°©í–ˆìŠµë‹ˆë‹¤!", {
              body: "ê³ ê° ìš”ì²­ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.",
              icon: "assets/css/main.css" // ì•„ì´ì½˜ ê²½ë¡œ(ì›í•˜ë©´ ë³€ê²½)
            });
          }
        }
        lastRequestCount = newCount;
        allRequests = data;
        renderTable();
      }
    }

    function openImageModal(src) {
      document.getElementById('imgModalContent').src = src;
      document.getElementById('imgModal').style.display = 'flex';
    }
    function closeImageModal() {
      document.getElementById('imgModal').style.display = 'none';
    }
  </script>
  <div id="imgModal" style="display:none; position:fixed; z-index:99999; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.7); align-items:center; justify-content:center;">
    <span onclick="closeImageModal()" style="position:absolute; top:24px; right:36px; color:#fff; font-size:2.5em; font-weight:700; cursor:pointer; z-index:100001;">&times;</span>
    <img id="imgModalContent" src="" style="max-width:90vw; max-height:80vh; border-radius:14px; box-shadow:0 8px 32px #0008;">
  </div>
</body>
</html> 