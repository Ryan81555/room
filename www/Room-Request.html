<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í¬ë¦¬ìŠ¤ì›”ë“œ ë¹Œë¦¬ì§€ ê°ì‹¤ ìš”ì²­/ë¬¸ì˜</title>
  <link rel="stylesheet" href="assets/css/main.css">
  <style>
    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }
    
    body { 
      background: linear-gradient(135deg, #e0e7ff 0%, #f0fdfa 100%); 
      margin: 0; 
      padding: 0; 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      min-height: 100vh;
    }
    
    .request-container { 
      max-width: 420px; 
      margin: 0 auto; 
      background: rgba(255,255,255,0.95); 
      border-radius: 0; 
      box-shadow: 0 4px 20px rgba(52,152,219,0.15); 
      padding: 20px 16px;
      min-height: 100vh;
    }
    
    .request-title { 
      text-align: center; 
      color: #2563eb; 
      margin-bottom: 20px; 
      font-size: 1.5em; 
      font-weight: 700;
      padding: 16px 0;
      background: linear-gradient(135deg, #4f8cff, #2563eb);
      color: white;
      border-radius: 12px;
      margin: 0 -16px 20px -16px;
    }
    
    .input-group { 
      margin-bottom: 20px; 
    }
    
    .input-label { 
      font-weight: 600; 
      margin-bottom: 8px; 
      display: block; 
      color: #1f2937;
      font-size: 0.95em;
    }
    
    .input-field, textarea { 
      width: 100%; 
      padding: 14px 12px; 
      border-radius: 12px; 
      border: 2px solid #e5e7eb; 
      font-size: 1em;
      transition: all 0.3s ease;
      background: #f9fafb;
    }
    
    .input-field:focus, textarea:focus {
      outline: none;
      border-color: #4f8cff;
      background: #fff;
      box-shadow: 0 0 0 3px rgba(79, 140, 255, 0.1);
    }
    
    .quick-btns { 
      display: flex; 
      flex-wrap: wrap; 
      gap: 8px; 
      margin-bottom: 16px; 
    }
    
    .quick-btn { 
      flex: 1 1 45%; 
      background: #f8fafc; 
      color: #374151; 
      border: 2px solid #e5e7eb; 
      border-radius: 12px; 
      padding: 12px 8px; 
      font-weight: 600; 
      cursor: pointer; 
      transition: all 0.3s ease; 
      font-size: 0.9em;
      text-align: center;
    }
    
    .quick-btn.selected, .quick-btn:hover { 
      background: linear-gradient(135deg, #4f8cff, #2563eb); 
      color: #fff;
      border-color: #4f8cff;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(79, 140, 255, 0.3);
    }
    
    .submit-btn { 
      width: 100%; 
      background: linear-gradient(135deg, #4f8cff, #2563eb); 
      color: #fff; 
      border: none; 
      border-radius: 12px; 
      padding: 16px 0; 
      font-size: 1.1em; 
      font-weight: 700; 
      cursor: pointer; 
      margin-top: 12px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(79, 140, 255, 0.3);
    }
    
    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(79, 140, 255, 0.4);
    }
    
    .submit-btn:disabled {
      background: #9ca3af;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    #adminLoginBox { 
      max-width: 340px;
      margin: 40px auto 0 auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      padding: 32px 18px; 
    }
    
    .notice-msg {
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      color: #92400e;
      border: 2px solid #f59e0b;
      border-radius: 12px;
      padding: 16px 12px;
      margin-bottom: 20px;
      font-size: 0.95em;
      text-align: center;
      font-weight: 500;
    }
    
    .notice-guide {
      background: linear-gradient(135deg, #dbeafe, #bfdbfe);
      color: #1e40af;
      border: 2px solid #60a5fa;
      border-radius: 12px;
      padding: 16px 12px;
      margin-bottom: 20px;
      font-size: 0.95em;
      text-align: center;
    }
    
    .notice-guide h3 {
      margin: 0 0 12px 0;
      font-size: 1.1em;
      color: #1e40af;
    }
    
    .notice-guide p {
      margin: 8px 0;
      line-height: 1.5;
    }
    
    .notice-guide hr {
      border: none;
      border-top: 1px solid #60a5fa;
      margin: 16px 0;
    }
    
    @media (max-width: 700px) {
      .request-container { 
        max-width: 100vw; 
        padding: 16px 12px; 
        border-radius: 0; 
        box-shadow: none; 
        margin: 0; 
      }
      
      .request-title { 
        font-size: 1.3em; 
        padding: 12px 0;
        margin: 0 -12px 16px -12px;
        border-radius: 0;
      }
      
      .input-field, textarea { 
        font-size: 1em; 
        padding: 16px 12px; 
      }
      
      .quick-btns { 
        flex-direction: column; 
        gap: 8px; 
      }
      
      .quick-btn { 
        width: 100%; 
        min-width: 0; 
        font-size: 0.95em; 
        padding: 14px 8px; 
      }
      
      .submit-btn { 
        font-size: 1.05em; 
        padding: 18px 0; 
      }
      
      #adminLoginBox { 
        max-width: 100vw; 
        border-radius: 0; 
        box-shadow: none; 
        margin: 0; 
      }
      
      .cafe-promo {
        padding: 16px 12px !important;
        font-size: 0.95em !important;
      }
      
      .cafe-promo img {
        width: 100% !important;
        max-width: 100vw !important;
        height: auto !important;
      }
      
      .cafe-gallery {
        flex-wrap: wrap;
        gap: 8px !important;
      }
      
      .cafe-gallery img {
        width: calc(50% - 4px) !important;
        max-width: 160px !important;
        min-width: 120px !important;
        margin-bottom: 8px;
      }
    }
  </style>
</head>
<body>
  <audio id="notifySound" src="sound/mlg-airhorn.mp3" preload="auto"></audio>
  <div class="request-container">
    <div class="request-title">ğŸ¨ í¬ë¦¬ìŠ¤ì›”ë“œ ë¹Œë¦¬ì§€<br>ê°ì‹¤ ìš”ì²­/ë¬¸ì˜</div>
    
    <div class="notice-msg">
      âš ï¸ ì›í™œí•œ ì„œë¹„ìŠ¤ ì œê³µê³¼ ì‹œìŠ¤í…œ ì•ˆì •í™”ë¥¼ ìœ„í•´ <br>
      ë¬¸ì˜ ë° ìš”ì²­ì‚¬í•­ ì ‘ìˆ˜ëŠ” <strong>3ë¶„ì— í•œ ë²ˆ</strong>ìœ¼ë¡œ ì œí•œë©ë‹ˆë‹¤.<br><br>
      ì§§ì€ ì‹œê°„ì— ì¤‘ë³µ ìš”ì²­ ì‹œ ì‹œìŠ¤í…œì— ê³¼ë¶€í•˜ê°€ ë°œìƒí•˜ê±°ë‚˜ <br>
      ìš”ì²­ì´ ëˆ„ë½ë  ìˆ˜ ìˆìœ¼ë‹ˆ, ì´ìš©ì ì—¬ëŸ¬ë¶„ì˜ ë„ˆê·¸ëŸ¬ìš´ ì–‘í•´ ë¶€íƒë“œë¦½ë‹ˆë‹¤.<br><br>
      <span style="color:#dc2626; font-weight: 600;">ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤.</span>
    </div>
    
    <div class="notice-guide">
      <h3>ğŸ“‹ ì´ˆê°„ë‹¨ ìš”ì²­ì‚¬í•­ ë° ë¬¸ì˜ì‚¬í•­ ë°©ë²•</h3>
      
      <p>
        <strong>1ï¸âƒ£ ë‚´ ì •ë³´ ì…ë ¥</strong><br>
        ë™/í˜¸ìˆ˜ì™€ ì „í™”ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì ì–´ì£¼ì„¸ìš”.
      </p>
      
      <p>
        <strong>2ï¸âƒ£ ìš”ì²­ì‚¬í•­ ì„ íƒ</strong><br>
        ìì£¼ ìˆëŠ” ìš”ì²­ ë²„íŠ¼ì„ ëˆ„ë¥´ê±°ë‚˜, <br>
        ì•„ë˜ ê¸°íƒ€ ìš”ì²­ì‚¬í•­ì— ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.
      </p>
      
      <p>
        <strong>3ï¸âƒ£ ì „ì†¡í•˜ë©´ ë!</strong><br>
        íŒŒë€ìƒ‰ ìš”ì²­í•˜ê¸° ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ <br>
        ë°”ë¡œ ì ‘ìˆ˜ë©ë‹ˆë‹¤.
      </p>
      
      <hr>
      
      <p>
        <strong>â­ ì¤‘ìš”:</strong> ì›í™œí•œ ì²˜ë¦¬ë¥¼ ìœ„í•´<br> 
        ìš”ì²­ì€ 3ë¶„ì— í•œ ë²ˆì”©ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤!
      </p>
    </div>
    
    <form id="requestForm">
      <div class="input-group">
        <label class="input-label" for="room">ğŸ  ë™/í˜¸ìˆ˜</label>
        <input class="input-field" type="text" id="room" name="room" placeholder="ì˜ˆ: Cë™ 101" required>
      </div>
      
      <div class="input-group">
        <label class="input-label" for="phone">ğŸ“ ì „í™”ë²ˆí˜¸</label>
        <input class="input-field" type="tel" id="phone" name="phone" placeholder="ì˜ˆ: 010-1234-5678" required>
      </div>
      
      <div class="input-group">
        <span class="input-label">âš¡ ìì£¼ ìˆëŠ” ìš”ì²­</span>
        <div class="quick-btns">
          <button type="button" class="quick-btn" data-type="ì˜ˆì•½ìƒë‹´">ğŸ“… ì˜ˆì•½ìƒë‹´</button>
          <button type="button" class="quick-btn" data-type="íœ´ì§€ê°€ ì—†ì–´ìš”">ğŸ§» íœ´ì§€ê°€ ì—†ì–´ìš”</button>
          <button type="button" class="quick-btn" data-type="TVê°€ ì•ˆ ë‚˜ì™€ìš”">ğŸ“º TVê°€ ì•ˆ ë‚˜ì™€ìš”</button>
          <button type="button" class="quick-btn" data-type="ë³€ê¸°ê°€ ë§‰í˜”ì–´ìš”">ğŸš½ ë³€ê¸°ê°€ ë§‰í˜”ì–´ìš”</button>
          <button type="button" class="quick-btn" data-type="í™”ì¥ì‹¤ ë¬¸ì´ ì ê²¼ì–´ìš”">ğŸ”’ í™”ì¥ì‹¤ ë¬¸ì´ ì ê²¼ì–´ìš”</button>
          <button type="button" class="quick-btn" data-type="ì¹¨êµ¬ë¥˜ë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ì–´ìš”.">ğŸ›ï¸ ì¹¨êµ¬ë¥˜ ì¶”ê°€</button>
          <button type="button" class="quick-btn" data-type="ì—ì–´ì»¨/ë‚œë°©ì´ ì˜ ì•ˆ ë¼ìš”.">â„ï¸ ì—ì–´ì»¨/ë‚œë°©</button>
          <button type="button" class="quick-btn" data-type="ì™€ì´íŒŒì´ê°€ ì—°ê²°ë˜ì§€ ì•Šì•„ìš”.">ğŸ“¶ ì™€ì´íŒŒì´ ì—°ê²°</button>
          <button type="button" class="quick-btn" data-type="ì¸ë•ì…˜ ì‘ë™í•˜ì§€ ì•Šì•„ìš”.">ğŸ”¥ ì¸ë•ì…˜ ì‘ë™</button>
          <button type="button" class="quick-btn" data-type="ë‹¤ë¥¸ ê°ì‹¤ì´ ë„ˆë¬´ ì‹œë„ëŸ¬ì›Œìš”.">ğŸ”‡ ì†ŒìŒ ë¬¸ì˜</button>
          <button type="button" class="quick-btn" data-type="ì˜¨ìˆ˜ê°€ ì•ˆë‚˜ì™€ìš”">ğŸš¿ ì˜¨ìˆ˜ ë¬¸ì˜</button>
        </div>
      </div>
      
      <div class="input-group">
        <label class="input-label" for="detail">ğŸ“ ê¸°íƒ€ ìš”ì²­ì‚¬í•­</label>
        <textarea id="detail" name="detail" rows="4" placeholder="ê¸°íƒ€ ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”."></textarea>
      </div>
      
      <button type="submit" class="submit-btn" id="submitBtn">ğŸ“¤ ìš”ì²­í•˜ê¸°</button>
    </form>
    
    <div id="resultMsg" style="display:none;"></div>
  </div>
  
  <!-- ìš”ì²­ ì™„ë£Œ ëª¨ë‹¬ -->
  <div id="successModal" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;">
    <div style="background:#fff;border-radius:20px;box-shadow:0 8px 32px rgba(34,197,94,0.2);padding:32px 24px;max-width:90vw;text-align:center;">
      <div style="font-size:1.3em;font-weight:700;color:#16a34a;margin-bottom:16px;">âœ… ì •ìƒì ìœ¼ë¡œ ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</div>
      <div style="color:#64748b;margin-bottom:20px;font-size:0.95em;">ì›í™œí•œ ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•´ ìš”ì²­ì€ 3ë¶„ì— í•œ ë²ˆì”©ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
      <button id="closeModalBtn" style="padding:12px 32px;background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff;border:none;border-radius:12px;font-size:1em;font-weight:600;cursor:pointer;transition:all 0.3s ease;">í™•ì¸</button>
    </div>
  </div>
  
  <!-- ìš”ì²­ ì‹¤íŒ¨ ëª¨ë‹¬ -->
  <div id="failureModal" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;">
    <div style="background:#fff;border-radius:20px;box-shadow:0 8px 32px rgba(239,68,68,0.2);padding:32px 24px;max-width:90vw;text-align:center;">
      <div style="font-size:1.3em;font-weight:700;color:#dc2626;margin-bottom:16px;">âŒ ìš”ì²­ ì ‘ìˆ˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>
      <div style="color:#64748b;margin-bottom:20px;font-size:0.95em;">ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”. (3ë¶„ì— 1ë²ˆì”© ìš”ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤.)</div>
      <button id="closeFailureModalBtn" style="padding:12px 32px;background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;border:none;border-radius:12px;font-size:1em;font-weight:600;cursor:pointer;transition:all 0.3s ease;">í™•ì¸</button>
    </div>
  </div>
  
  <div class="cafe-promo" style="
    background: linear-gradient(135deg, #fff7ed, #fed7aa);
    border: 2px solid #fdba74;
    border-radius: 16px;
    padding: 20px;
    margin: 20px 16px;
    text-align: center;
    color: #92400e;
    font-weight: 600;
    font-size: 1.05em;
  ">
    <div style="margin-bottom: 16px;">
      <strong>â˜• ì¹´í˜ í¬ë¦¬ìŠ¤ì›”ë“œ</strong><br>
      <span style="font-size: 0.9em; color: #a16207;">ë§›ìˆëŠ” ì»¤í”¼ì™€ í•¨ê»˜í•˜ëŠ” íŠ¹ë³„í•œ ì‹œê°„</span>
    </div>
    
    <div class="cafe-gallery" style="
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 16px;
    ">
      <img src="images/101.jpg" alt="ì¹´í˜ ì´ë¯¸ì§€ 1" style="width: 120px; height: 90px; object-fit: cover; border-radius: 8px; border: 2px solid #fdba74;">
      <img src="images/102.jpg" alt="ì¹´í˜ ì´ë¯¸ì§€ 2" style="width: 120px; height: 90px; object-fit: cover; border-radius: 8px; border: 2px solid #fdba74;">
      <img src="images/104.jpg" alt="ì¹´í˜ ì´ë¯¸ì§€ 3" style="width: 120px; height: 90px; object-fit: cover; border-radius: 8px; border: 2px solid #fdba74;">
    </div>
    
    <div style="margin-top: 16px; font-size: 0.9em; color: #a16207;">
      ğŸ• ì˜ì—…ì‹œê°„: 08:00 - 22:00<br>
      ğŸ“ ìœ„ì¹˜: 1ì¸µ ë¡œë¹„ ì˜†
    </div>
  </div>

  <script>
    let selectedType = '';
    let canSubmit = true;
    let submitTimeout;

    document.addEventListener('DOMContentLoaded', function() {
      const audio = document.getElementById('notifySound');
      if (!audio._endedEventRegistered) {
        audio.addEventListener('ended', function() {
          if (window.notifyLooping) {
            audio.currentTime = 0;
            audio.play();
          }
        });
        audio._endedEventRegistered = true;
      }
      window.notifyAudio = audio;
      window.notifyLooping = false;
    });

    // ë¸Œë¼ìš°ì € í‘¸ì‰¬ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
    if (window.Notification && Notification.permission !== "granted") {
      Notification.requestPermission();
    }

    document.querySelectorAll('.quick-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.quick-btn').forEach(b => b.classList.remove('selected'));
        this.classList.add('selected');
        selectedType = this.getAttribute('data-type');
        document.getElementById('detail').value = selectedType;
      });
    });

    document.getElementById('requestForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      if (!canSubmit) {
        showFailureModal();
        return;
      }

      const formData = new FormData(this);
      const data = {
        room: formData.get('room'),
        phone: formData.get('phone'),
        type: selectedType || 'ê¸°íƒ€',
        detail: formData.get('detail')
      };

      try {
        const response = await fetch('/api/requests', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        });

        if (response.ok) {
          showSuccessModal();
          this.reset();
          selectedType = '';
          document.querySelectorAll('.quick-btn').forEach(b => b.classList.remove('selected'));
          
          // 3ë¶„ê°„ ì œì¶œ ë¹„í™œì„±í™”
          canSubmit = false;
          const submitBtn = document.getElementById('submitBtn');
          submitBtn.disabled = true;
          submitBtn.textContent = 'â³ 3ë¶„ ëŒ€ê¸° ì¤‘...';
          
          let timeLeft = 180; // 3ë¶„ = 180ì´ˆ
          submitTimeout = setInterval(() => {
            timeLeft--;
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            submitBtn.textContent = `â³ ${minutes}:${seconds.toString().padStart(2, '0')} ëŒ€ê¸° ì¤‘...`;
            
            if (timeLeft <= 0) {
              clearInterval(submitTimeout);
              canSubmit = true;
              submitBtn.disabled = false;
              submitBtn.textContent = 'ğŸ“¤ ìš”ì²­í•˜ê¸°';
            }
          }, 1000);
          
        } else {
          showFailureModal();
        }
      } catch (error) {
        console.error('ìš”ì²­ ì „ì†¡ ì¤‘ ì˜¤ë¥˜:', error);
        showFailureModal();
      }
    });

    function showSuccessModal() {
      const modal = document.getElementById('successModal');
      modal.style.display = 'flex';
      
      // ì•Œë¦¼ìŒ ì¬ìƒ
      const audio = window.notifyAudio;
      if (audio) {
        audio.currentTime = 0;
        audio.play();
      }
      
      // ì§„ë™ (ì§€ì›í•˜ëŠ” ê²½ìš°)
      if (navigator.vibrate) {
        navigator.vibrate([100, 50, 100]);
      }
      
      // í‘¸ì‹œ ì•Œë¦¼
      if (window.Notification && Notification.permission === "granted") {
        new Notification("ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤!", {
          body: "ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ì²˜ë¦¬í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
          icon: "/Room Request/images/101.jpg"
        });
      }
    }

    function showFailureModal() {
      const modal = document.getElementById('failureModal');
      modal.style.display = 'flex';
    }

    document.getElementById('closeModalBtn').addEventListener('click', function() {
      document.getElementById('successModal').style.display = 'none';
    });

    document.getElementById('closeFailureModalBtn').addEventListener('click', function() {
      document.getElementById('failureModal').style.display = 'none';
    });

    // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/Room Request/server/sw.js');
    }
  </script>
</body>
</html> 